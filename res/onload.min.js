if(!String.format){String.format=function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/{(\d+)}/g,function(c,d){return typeof a[d]!="undefined"?a[d]:c})}}var commitlink;var homeworkname;var msg_error_download="ERROR 404";var timeoutlist=[];jQuery(document).ready(function(a){homeworkname=a("#homework_name").html();a("#main_list > div").map(function(){if(this.id!=""){commitlink=a(String.format("#{0} .user_inner .calendar",this.id)).attr("href");cookie_status=Cookies.get(this.id+homeworkname);a(String.format("#{0} .user_inner .download",this.id)).click(function(f){clicked_id=a(this).attr("data-user");a(String.format("#{0} .user_inner .status img",clicked_id)).attr("style","display: none");a(String.format("#{0} .user_inner .status .status_date",clicked_id)).html("");a(String.format("#{0} .user_inner .status .progress-bar-circle",clicked_id)).attr("style","display: block");var e=new ProgressBar.Circle(String.format("#{0} .user_inner .status .progress-bar-circle",clicked_id),{strokeWidth:20,easing:"easeInOut",duration:timewait_check,color:"#3598DB",trailColor:"#eee",trailWidth:1,svgStyle:null});e.animate(1);timeout=setTimeout(function(){Cookies.remove(clicked_id+homeworkname);Cookies.set(clicked_id+homeworkname,{downloaded:true,date_download:new Date().toLocaleString(),homework:homeworkname},{expires:14});a(String.format("#{0} .user_inner .status .progress-bar-circle",clicked_id)).removeAttr("style");a(String.format("#{0} .user_inner .status .progress-bar-circle",clicked_id)).html("");a(String.format("#{0} .user_inner .status img",clicked_id)).attr("src","res/check.png");a(String.format("#{0} .user_inner .status img",clicked_id)).removeAttr("style");a(String.format("#{0} .user_inner .status .status_date",clicked_id)).html(new Date().toLocaleString());for(var g=0;g<timeoutlist.length;g++){if(timeoutlist[g][1]==clicked_id){timeoutlist.splice(g,1);break}}},timewait_check);timeoutlist.push([timeout,clicked_id])})}if(cookie_status!=Cookies.undefined&&this.id!=""){try{var c=JSON.parse(cookie_status);if(c.homework==homeworkname){if(c.downloaded){a(String.format("#{0} .user_inner .status img",this.id)).attr("src","res/check.png")}a(String.format("#{0} .user_inner .status .status_date",this.id)).html(c.date_download);if(c.date_download==msg_error_download){a(String.format("#{0}",this.id)).attr("class","error_download");a(String.format("#{0} .user_inner .download",this.id)).unbind("click");a(String.format("#{0} .user_inner .download",this.id)).removeAttr("href");a(String.format("#{0} .user_inner .calendar",this.id)).removeAttr("href");a(String.format("#{0} .user_inner .usernamelink",this.id)).removeAttr("href")}}}catch(d){}}});a("#reset_button").click(function(){console.log("Reset download list");a("#main_list > div").map(function(){Cookies.remove(this.id+homeworkname)});location.reload()});var b=600;a(window).scroll(function(){location.pathname.replace(/^\//,"");if(a(window).scrollTop()>b){a("a.back-to-top").fadeIn("slow")}else{a("a.back-to-top").fadeOut("slow")}});a(function(){a('a[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var c=a(this.hash);c=c.length?c:a("[name="+this.hash.slice(1)+"]");if(c.length){a("html, body").animate({scrollTop:c.offset().top},700);return false}}})})});$(window).on("unload",function(b){if(timeoutlist.length>0){console.log("Canceling all timeouts");for(var a=0;a<timeoutlist.length;a++){try{clearTimeout(timeoutlist[a][0]);Cookies.remove(timeoutlist[a][1]+homeworkname);Cookies.set(timeoutlist[a][1]+homeworkname,{downloaded:false,date_download:msg_error_download,homework:homeworkname},{expires:14})}catch(b){}finally{}}}});